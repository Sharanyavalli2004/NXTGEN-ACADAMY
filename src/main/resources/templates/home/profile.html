<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Teacher Profile</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
<div class="flex h-screen">
  <!-- Sidebar -->
  <aside class="w-64 bg-white shadow-md overflow-y-auto">
    <div class="p-6 text-2xl font-bold text-indigo-600">Teacher Panel</div>
    <nav class="mt-6">
      <ul class="space-y-2 text-gray-700">
        <li><a href="/teacher/dashboard" class="block px-6 py-2 hover:bg-indigo-100 rounded">Dashboard</a></li>
        <li><a href="/teacher/profile" class="block px-6 py-2 bg-indigo-100 rounded font-semibold">Profile Setup</a></li>
        <li><a href="/teacher/attendence" class="block px-6 py-2 hover:bg-indigo-100 rounded">Attendance</a></li>
        <li><a href="/teacher/timetable" class="block px-6 py-2 hover:bg-indigo-100 rounded">Timetable</a></li>
        <li><a href="/teacher/examinations" class="block px-6 py-2 hover:bg-indigo-100 rounded">Examinations</a></li>
      </ul>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 p-8 overflow-y-auto">
    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Profile Setup</h2>

    <!-- Resume View -->
    <div id="profileView">
      <div class="bg-white p-6 rounded shadow space-y-2">
        <p><strong>First Name:</strong> <span th:text="${profile.firstName}"></span></p>
        <p><strong>Last Name:</strong> <span th:text="${profile.lastName}"></span></p>
        <p><strong>Phone:</strong> <span th:text="${profile.phone}"></span></p>
        <p><strong>Email:</strong> <span th:text="${profile.email}"></span></p>
        <p><strong>Address:</strong> <span th:text="${profile.address}"></span></p>
        <p><strong>Subject:</strong> <span th:text="${profile.subject}"></span></p>
        <p><strong>Custom Subject:</strong> <span th:text="${profile.customSubject}"></span></p>
        <p><strong>Experience:</strong> <span th:text="${profile.experience}"></span></p>
        <div th:if="${profile.experience} == 'Yes'">
          <p><strong>Past School:</strong> <span th:text="${profile.pastSchool}"></span></p>
          <p><strong>Past Address:</strong> <span th:text="${profile.pastAddress}"></span></p>
          <p><strong>Past Subject:</strong> <span th:text="${profile.pastSubject}"></span></p>
        </div>
      </div>
      <button onclick="toggleEdit(true)" class="mt-4 px-6 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600">Edit</button>
    </div>

    <!-- Edit Form -->
    <form id="profileForm" class="space-y-4 hidden" method="post" th:action="@{/teacher/profile/save}" th:object="${profile}">
      <input type="hidden" th:field="*{id}" />
      <div><label>First Name</label><input type="text" th:field="*{firstName}" class="w-full px-4 py-2 border rounded" /></div>
      <div><label>Last Name</label><input type="text" th:field="*{lastName}" class="w-full px-4 py-2 border rounded" /></div>
      <div><label>Phone</label><input type="text" th:field="*{phone}" class="w-full px-4 py-2 border rounded" /></div>
      <div><label>Email</label><input type="email" th:field="*{email}" class="w-full px-4 py-2 border rounded" /></div>
      <div><label>Address</label><input type="text" th:field="*{address}" class="w-full px-4 py-2 border rounded" /></div>
      <div><label>Subject</label><input type="text" th:field="*{subject}" class="w-full px-4 py-2 border rounded" /></div>
      <div><label>Custom Subject</label><input type="text" th:field="*{customSubject}" class="w-full px-4 py-2 border rounded" /></div>
      <div>
        <label>Experience</label>
        <select th:field="*{experience}" id="experience" class="w-full px-4 py-2 border rounded">
          <option value="No">No</option>
          <option value="Yes">Yes</option>
        </select>
      </div>
      <div id="experienceFields" class="hidden">
        <div><label>Past School</label><input type="text" th:field="*{pastSchool}" class="w-full px-4 py-2 border rounded" /></div>
        <div><label>Past Address</label><input type="text" th:field="*{pastAddress}" class="w-full px-4 py-2 border rounded" /></div>
        <div><label>Past Subject</label><input type="text" th:field="*{pastSubject}" class="w-full px-4 py-2 border rounded" /></div>
      </div>

      <div class="flex space-x-4 mt-6">
        <button type="submit" class="px-6 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">Save</button>
        <button type="button" class="px-6 py-2 bg-gray-500 text-white rounded hover:bg-gray-600" onclick="toggleEdit(false)">Cancel</button>
      </div>
    </form>
  </main>
</div>

<script>
  function toggleEdit(showForm) {
    document.getElementById('profileForm').style.display = showForm ? 'block' : 'none';
    document.getElementById('profileView').style.display = showForm ? 'none' : 'block';
  }

  // Toggle experience-related fields
  const experienceSelect = document.getElementById("experience");
  const experienceFields = document.getElementById("experienceFields");

  function toggleExperienceFields() {
    experienceFields.classList.toggle("hidden", experienceSelect.value !== "Yes");
  }

  experienceSelect?.addEventListener("change", toggleExperienceFields);

  // Call once on load if value is already set to "Yes"
  document.addEventListener("DOMContentLoaded", toggleExperienceFields);
</script>
</body>
</html>
